<UserControl x:Class="Wysg.Musm.Radium.Controls.StatusActionsBar"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             Loaded="OnLoaded">
    <UserControl.Resources>
        <BooleanToVisibilityConverter x:Key="BoolToVisibilityConverter"/>
        <!-- Fallback style used only if parent does not provide DarkToggleButtonStyle -->
        <Style x:Key="_LocalDarkToggleButtonStyle" TargetType="ToggleButton">
            <Setter Property="Background" Value="#2D2D30"/>
            <Setter Property="Foreground" Value="#D0D0D0"/>
            <Setter Property="BorderBrush" Value="#3C3C3C"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="8,4"/>
            <Setter Property="Margin" Value="8,0,0,0"/>
        </Style>
    </UserControl.Resources>
    <ScrollViewer HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Disabled">
        <Grid Margin="6,4,6,4">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>
            <StackPanel Orientation="Horizontal" Grid.Column="0">
                <Button Content="Manage studyname" Command="{Binding OpenStudynameMapCommand}" ToolTip="Current studyname is missing a LOINC mapping." ToolTipService.IsEnabled="{Binding StudynameMappingNeedsAttention}">
                    <Button.Style>
                        <Style TargetType="Button">
                            <Setter Property="Padding" Value="8,4"/>
                            <Setter Property="Margin" Value="0"/>
                            <Setter Property="Background" Value="#FF1E1E1E"/>
                            <Setter Property="Foreground" Value="#FFE0E0E0"/>
                            <Setter Property="BorderBrush" Value="#FF3C3C3C"/>
                            <Setter Property="BorderThickness" Value="1"/>
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding StudynameMappingNeedsAttention}" Value="True">
                                    <Setter Property="Background" Value="#FFB3261E"/>
                                    <Setter Property="BorderBrush" Value="#FF7A1B13"/>
                                    <Setter Property="Foreground" Value="#FFFFFFFF"/>
                                    <Setter Property="FontWeight" Value="Bold"/>
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </Button.Style>
                </Button>
                <Separator Width="10"/>
                <Button Content="Force Ghost" Click="OnForceGhost_Click"/>
                <Button Content="Settings" Click="OnOpenSettings_Click"/>
                <Button Content="Automation" Click="OnOpenSpy_Click"/>
                <ToggleButton Content="Align Right" Style="{DynamicResource DarkToggleButtonStyle}" Margin="8,0,0,0"
                              Checked="OnAlignRight_Toggled" Unchecked="OnAlignRight_Toggled"/>
                <ToggleButton Content="Reverse Reports" Style="{DynamicResource DarkToggleButtonStyle}" Margin="8,0,0,0"
                              Checked="OnReverseReports_Toggled" Unchecked="OnReverseReports_Toggled"/>
            </StackPanel>
            <StackPanel Orientation="Horizontal" Grid.Column="1" HorizontalAlignment="Right">
                <!-- Current User and PACS Display -->
                <TextBlock Text="{Binding CurrentUserDisplay, FallbackValue='User: user@example.com'}" 
                           VerticalAlignment="Center" Foreground="#C8C8C8" Margin="0,0,12,0"
                           FontSize="11"/>
                <TextBlock Text="{Binding CurrentPacsDisplay, FallbackValue='PACS: default_pacs'}" 
                           VerticalAlignment="Center" Foreground="#C8C8C8" Margin="0,0,12,0"
                           FontSize="11"/>
                <!-- Always on Top Checkbox -->
                <CheckBox x:Name="chkAlwaysOnTop" Content="Always on Top" 
                          VerticalAlignment="Center" Margin="0,0,12,0"
                          Foreground="#C8C8C8" FontSize="11"
                          Checked="OnAlwaysOnTop_Checked" Unchecked="OnAlwaysOnTop_Unchecked"/>
                <Button Content="Log out" Click="OnLogout_Click" Margin="0,0,6,0"/>
            </StackPanel>
        </Grid>
    </ScrollViewer>
</UserControl>
