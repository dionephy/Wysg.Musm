<UserControl x:Class="Wysg.Musm.Radium.Controls.PreviousReportTextAndJsonPanel"
         xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
     xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
  mc:Ignorable="d" 
         d:DesignHeight="450" d:DesignWidth="800" >

    <UserControl.Resources>
    <FontFamily x:Key="UiMonospaceFont">pack://application:,,,/Wysg.Musm.Radium;component/Fonts/#D2Coding</FontFamily>
        
 <Style x:Key="DarkToggleButtonStyle" TargetType="ToggleButton">
            <Setter Property="Background" Value="#2D2D30"/>
            <Setter Property="Foreground" Value="#D0D0D0"/>
            <Setter Property="BorderBrush" Value="#3C3C3C"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="6,3"/>
            <Setter Property="Margin" Value="4,0,0,0"/>
            <Setter Property="FontFamily" Value="{StaticResource UiMonospaceFont}"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ToggleButton">
                        <Border x:Name="border"
                        Background="{TemplateBinding Background}"
                        BorderBrush="{TemplateBinding BorderBrush}"
                        BorderThickness="{TemplateBinding BorderThickness}"
                        CornerRadius="2">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsChecked" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#3C3C3C"/>
                                <Setter TargetName="border" Property="BorderBrush" Value="#2F65C8"/>
                            </Trigger>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="BorderBrush" Value="#2F65C8"/>
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter Property="Opacity" Value="0.6"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </UserControl.Resources>
    
    <!-- True Grid-Based Row Layout for Previous Reports -->
    <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled">
        <Grid>
            <Grid.ColumnDefinitions>
               <ColumnDefinition Width="1*" MinWidth="200"/>
    <ColumnDefinition Width="2"/>
          <ColumnDefinition Width="1*" MinWidth="200"/>
     <ColumnDefinition Width="2"/>
                <ColumnDefinition Width="1*" MinWidth="200"/>
            </Grid.ColumnDefinitions>
            
       <Grid.RowDefinitions>
      <!-- Row 0: Headers -->
          <RowDefinition Height="Auto"/>
          <!-- Row 1: Header and Findings / Proofread header section -->
      <RowDefinition Height="Auto"/>
    <!-- Row 2: Header and Findings textboxes -->
         <RowDefinition Height="Auto"/>
    <!-- Row 3: Split controls -->
      <RowDefinition Height="Auto"/>
      <!-- Row 4: Final Conclusion label -->
       <RowDefinition Height="Auto"/>
   <!-- Row 5: Final Conclusion textboxes -->
      <RowDefinition Height="Auto"/>
    <!-- Row 6: Second split controls -->
             <RowDefinition Height="Auto"/>
          <!-- Row 7: Header temp label -->
          <RowDefinition Height="Auto"/>
   <!-- Row 8: Header temp textboxes -->
          <RowDefinition Height="Auto"/>
      <!-- Rows 9-16: REMOVED (Chief Complaint, Patient History, Study Techniques, Comparison) -->
      <!-- Row 9 (previously 17): Findings split label -->
         <RowDefinition Height="Auto"/>
     <!-- Row 10 (previously 18): Findings split textboxes -->
     <RowDefinition Height="Auto"/>
      <!-- Row 11 (previously 19): Conclusion split label -->
    <RowDefinition Height="Auto"/>
          <!-- Row 12 (previously 20): Conclusion split textboxes -->
         <RowDefinition Height="Auto"/>
       </Grid.RowDefinitions>

            <!-- Row 0: Column Headers -->
            <TextBlock Grid.Row="0" Grid.Column="0" Text="Previous Report" FontWeight="Bold" Margin="6,0,0,8"/>
 <TextBlock Grid.Row="0" Grid.Column="2" Text="Proofread" FontWeight="Bold" Margin="6,0,0,8"/>

    <TextBlock Grid.Row="1" Grid.Column="0" Text="Previous Header and Findings" Margin="6,0,0,2"/>
            
      <!-- Row 2: Header and Findings Textboxes -->
            <TextBox x:Name="txtHeaderAndFindings" Grid.Row="2" Grid.Column="0"
         Text="{Binding HeaderAndFindingsText, RelativeSource={RelativeSource AncestorType=UserControl}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
           Padding="6" Margin="0,0,0,4" TextWrapping="Wrap" AcceptsReturn="True"/>

      <!-- Row 3: Split Controls (main column only) -->
            <StackPanel Grid.Row="3" Grid.Column="0" Orientation="Horizontal" Margin="6,2,0,8">
      <Button Content="Split Header" FontSize="10" Padding="4,2" Margin="0,0,0,0" 
      Command="{Binding SplitHeaderTopCommand}"
  CommandParameter="{Binding ElementName=txtHeaderAndFindings}"/>
   <Button Content="Split Conclusion" FontSize="10" Padding="4,2" Margin="4,0,0,0" 
    Command="{Binding SplitConclusionCommand}"
            CommandParameter="{Binding ElementName=txtHeaderAndFindings}"/>
    <ToggleButton Content="Auto Split" FontSize="10" Padding="4,2" 
 Style="{StaticResource DarkToggleButtonStyle}"
          IsChecked="{Binding AutoSplit, Mode=TwoWay}"/>
       </StackPanel>

 <!-- Row 4: Final Conclusion Label -->
    <TextBlock Grid.Row="4" Grid.Column="0" Text="Final Conclusion" Margin="6,4,0,2"/>
      
            <!-- Row 5: Final Conclusion Textboxes -->
     <TextBox x:Name="txtFinalConclusion" Grid.Row="5" Grid.Column="0"
      Text="{Binding FinalConclusionText, RelativeSource={RelativeSource AncestorType=UserControl}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
     Padding="6" Margin="0,0,0,4" TextWrapping="Wrap" AcceptsReturn="True"/>
   
         <!-- Row 6: Second Split Controls (main column only) -->
      <StackPanel Grid.Row="6" Grid.Column="0" Orientation="Horizontal" Margin="6,2,0,8">
      <Button Content="Split Header" FontSize="10" Padding="4,2" Margin="0,0,0,0" 
      Command="{Binding SplitHeaderBottomCommand}"
                 CommandParameter="{Binding ElementName=txtFinalConclusion}"/>
      <Button Content="Split Findings" FontSize="10" Padding="4,2" Margin="4,0,0,0" 
  Command="{Binding SplitFindingsCommand}"
      CommandParameter="{Binding ElementName=txtFinalConclusion}"/>
       <ToggleButton Content="Auto Split" FontSize="10" Padding="4,2" 
         Style="{StaticResource DarkToggleButtonStyle}"
      IsChecked="{Binding AutoSplit, Mode=TwoWay}"/>
            </StackPanel>

            <!-- Row 7: Header temp Label -->
            <TextBlock Grid.Row="7" Grid.Column="0" Text="Header (temp)" Margin="6,6,0,2"/>
            
      <!-- Row 8: Header temp Textboxes -->
            <TextBox Grid.Row="8" Grid.Column="0" Padding="6" Margin="0,0,0,4" TextWrapping="Wrap" AcceptsReturn="True"
         Text="{Binding HeaderTemp, RelativeSource={RelativeSource AncestorType=UserControl}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>

            <!-- REMOVED: Rows 9-16 (Chief Complaint, Patient History, Study Techniques, Comparison and their proofread versions) -->

            <!-- Row 9 (previously 17): Findings split Labels -->
        <TextBlock Grid.Row="9" Grid.Column="0" Text="Findings (split)" Margin="6,6,0,2"/>
          
    <StackPanel Grid.Row="9" Grid.Column="2" Orientation="Horizontal" Margin="6,6,0,2">
     <TextBlock Text="Findings (PR)" VerticalAlignment="Center" FontSize="11"/>
     <ToggleButton Content="auto" FontSize="10" Padding="4,2" Margin="6,0,0,0" Style="{StaticResource DarkToggleButtonStyle}"
     IsChecked="{Binding DataContext.AutoFindingsProofread, RelativeSource={RelativeSource AncestorType=Window}, Mode=TwoWay}"/>
            <Button Content="gen" FontSize="10" Padding="4,2" Margin="3,0,0,0"
        Command="{Binding DataContext.GenerateFieldCommand, RelativeSource={RelativeSource AncestorType=Window}}"
       CommandParameter="findings_proofread"/>
            </StackPanel>
            
     <!-- Row 10 (previously 18): Findings split Textboxes -->
    <TextBox Grid.Row="10" Grid.Column="0" Padding="6" Margin="0,0,0,4" TextWrapping="Wrap" AcceptsReturn="True"
    Text="{Binding SplitFindings, RelativeSource={RelativeSource AncestorType=UserControl}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
         
      <TextBox Grid.Row="10" Grid.Column="2" Padding="6" Margin="0,0,0,4" TextWrapping="Wrap" AcceptsReturn="True">
                <TextBox.Style>
    <Style TargetType="TextBox" BasedOn="{StaticResource {x:Type TextBox}}">
        <Setter Property="Text" Value="{Binding FindingsProofread, RelativeSource={RelativeSource AncestorType=UserControl}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
             <Setter Property="IsReadOnly" Value="False"/>
        <Style.Triggers>
   <DataTrigger Binding="{Binding DataContext.ProofreadMode, RelativeSource={RelativeSource AncestorType=Window}}" Value="True">
                 <Setter Property="Text" Value="{Binding DataContext.FindingsProofreadDisplay, RelativeSource={RelativeSource AncestorType=Window}, Mode=OneWay}"/>
     <Setter Property="IsReadOnly" Value="True"/>
         </DataTrigger>
        </Style.Triggers>
     </Style>
     </TextBox.Style>
  </TextBox>

            <!-- Row 11 (previously 19): Conclusion split Labels -->
            <TextBlock Grid.Row="11" Grid.Column="0" Text="Conclusion (split)" Margin="6,6,0,2"/>
            
       <StackPanel Grid.Row="11" Grid.Column="2" Orientation="Horizontal" Margin="6,6,0,2">
  <TextBlock Text="Conclusion (PR)" VerticalAlignment="Center" FontSize="11"/>
        <ToggleButton Content="auto" FontSize="10" Padding="4,2" Margin="6,0,0,0" Style="{StaticResource DarkToggleButtonStyle}"
     IsChecked="{Binding DataContext.AutoConclusionProofread, RelativeSource={RelativeSource AncestorType=Window}, Mode=TwoWay}"/>
         <Button Content="gen" FontSize="10" Padding="4,2" Margin="3,0,0,0"
    Command="{Binding DataContext.GenerateFieldCommand, RelativeSource={RelativeSource AncestorType=Window}}"
       CommandParameter="conclusion_proofread"/>
         </StackPanel>
        
    <!-- Row 12 (previously 20): Conclusion split Textboxes -->
    <TextBox Grid.Row="12" Grid.Column="0" Padding="6" Margin="0,0,0,8" TextWrapping="Wrap" AcceptsReturn="True"
     Text="{Binding SplitConclusion, RelativeSource={RelativeSource AncestorType=UserControl}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
            
  <TextBox Grid.Row="12" Grid.Column="2" Padding="6" Margin="0,0,0,8" TextWrapping="Wrap" AcceptsReturn="True">
      <TextBox.Style>
<Style TargetType="TextBox" BasedOn="{StaticResource {x:Type TextBox}}">
    <Setter Property="Text" Value="{Binding ConclusionProofread, RelativeSource={RelativeSource AncestorType=UserControl}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
<Setter Property="IsReadOnly" Value="False"/>
    <Style.Triggers>
  <DataTrigger Binding="{Binding DataContext.ProofreadMode, RelativeSource={RelativeSource AncestorType=Window}}" Value="True">
   <Setter Property="Text" Value="{Binding DataContext.ConclusionProofreadDisplay, RelativeSource={RelativeSource AncestorType=Window}, Mode=OneWay}"/>
  <Setter Property="IsReadOnly" Value="True"/>
      </DataTrigger>
   </Style.Triggers>
      </Style>
       </TextBox.Style>
      </TextBox>

         <!-- GridSplitters -->
        <GridSplitter Grid.Row="0" Grid.RowSpan="13" Grid.Column="1" HorizontalAlignment="Stretch" Width="2" Background="#2D2D30"/>
     <GridSplitter Grid.Row="0" Grid.RowSpan="13" Grid.Column="3" HorizontalAlignment="Stretch" Width="2" Background="#2D2D30"/>

            <!-- Column 4: JSON (spans all rows) -->
    <TextBox x:Name="txtJson" Grid.Row="0" Grid.RowSpan="13" Grid.Column="4" 
             Text="{Binding JsonText, RelativeSource={RelativeSource AncestorType=UserControl}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
      Padding="6" Margin="0" TextWrapping="Wrap" VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled" 
    AcceptsReturn="True" VerticalAlignment="Stretch"/>
      </Grid>
    </ScrollViewer>
</UserControl>
